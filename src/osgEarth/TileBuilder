#ifndef OSGEARTH_TILE_BUILDER_H
#define OSGEARTH_TILE_BUILDER_H 1

#include <osgEarth/Common>
#include <osgEarth/PlateCarre>
#include <osgEarth/MapConfig>
#include <vector>

namespace osgEarth
{
    class OSGEARTH_EXPORT TileBuilder : public osg::Referenced
    {
    public:
        static TileBuilder* create( MapConfig* map, const std::string& url_template );
        
    public:
        osg::Node* createNode( const PlateCarreCellKey& key );

    protected:
        TileBuilder( MapConfig* map, const std::string& url_template );

        std::string createURI( const PlateCarreCellKey& key );

        virtual osg::Node* createQuadrant( const PlateCarreCellKey& key ) =0;
        virtual std::string getProj4String() const =0;

    protected:
        osg::ref_ptr<MapConfig> map;
        std::string url_template;
        std::vector< osg::ref_ptr<PlateCarreTileSource> > image_sources;
        std::vector< osg::ref_ptr<PlateCarreTileSource> > heightfield_sources;
    };
};

#endif // OSGEARTH_TILE_BUILDER_H